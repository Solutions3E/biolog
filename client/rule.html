<template name="rule">
    <div class="container-fluid">
        <form class="form-horizontal biolog-new-rule">

            <div class="form-group">
                <label for="ruleName" class="col-sm-2 control-label">Title</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="ruleName" id="ruleName" placeholder="Rule Title" size="30"/>
                </div>
            </div>

            <div class="form-group">
                <label for="ruleDescription" class="col-sm-2 control-label">Message</label>
                <div class="col-sm-10">
                    <textarea class="form-control" rows="3" name="ruleDescription" id="ruleDescription"
                            placeholder="Text to display when the rule applies"></textarea>
                </div>
            </div>

            <h2 class="panel-title">Flag this rule for any <b>{{etypeName}}</b> that has:</h2>

            {{#with rule.block}}
            <div class="container-fluid move-down-in-panel">
                {{> blockDisplay}}
            </div>
            {{/with}}
        </form>
    </div>
</template>




<!--Main window-->
<template name="blockDisplay">
    <div class="{{blockPanelColor}}">
        <!--<div class="panel-body">-->
        <div class="row">
            <span class="pull-left biolog-menuButton">
                <select name="selectAndOr" class="selectAndOr" id="{{path}}">
                    <option value="AND" {{andSelected}}>ALL of these (AND)</option>
                    <option value="OR" {{orSelected}}>ANY of these (OR)</option>
                </select>
            </span>
            <span class="dropdown pull-left">
                <button
                        data-toggle="dropdown"
                        class="btn btn-primary btn-xs biolog-menuButton dropdown-toggle"
                        type="button"
                        title="Add an IF">
                    IF...
                </button>
                <!--<a data-toggle="dropdown" href="#">Dropdown trigger</a>-->
                <ul class="dropdown-menu" role="menu">
                    <li role="presentation"><a tabindex="-1" role="menuitem" href="#" class="biolog-addDiagnosis" id="{{path}}">has Diagnosis...</a></li>
                    <li role="presentation"><a tabindex="-1" role="menuitem" href="#" class="biolog-addMedication" id="{{path}}">takes Medication...</a></li>
                    <li class="divider" role="presentation"></li>
                    <li role="presentation"><a tabindex="-1" role="menuitem" href="#" class="biolog-addBlock" id="{{path}}">Add a BLOCK: ( ... )</a></li>
                </ul>
                <!--<ul class="dropdown-menu" role="menu">-->
                    <!--<li role="presentation"><a role="menuitem" href="#" id="biolog-blockDisplay-diagnosis">Diagnosis is...</a></li>-->
                <!--</ul>-->
            </span>
            <span class="pull-right">
                <button id="{{path}}" class="btn btn-danger btn-xs biolog-removeThisBlock {{displayRemoveButton}} biolog-menuButton" title="Remove this block">
                    <span class="fa fa-close"></span>
                </button>
            </span>
        </div>

        {{#each clauses}}
        {{displayConjunction}}
        {{> clauseDisplay}}
        {{/each}}
        <div>
        {{conjunctionBeforeBlocks}}
        </div>
        {{#each blocks}}
        {{displayParentConjunction}}
        {{> blockDisplay}}
        {{/each}}
    </div>
</template>




<template name="clauseDisplay">
    <!--{{displayConjunction}}-->
    <div class="btn-group" role="group" aria-label="...">
        <button class="btn btn-default btn-sm biolog-objectButtons-negateBtn {{notHidden}}" title="negate">
            NOT
        </button>
        <button id="{{parentPath ..}}" class="btn btn-default btn-sm biolog-deleteObjBtn" title="remove">
            {{pred.name}}: {{object.name}}  <span class="fa fa-close"></span>
        </button>
    </div>
</template>




<template name="valueSelector">
    <div class="row">
        <div class="col col-md-6">
            {{> esInput index="entities" placeholder="Select..." id="objectChooser" }}
        </div>
    </div>

    <div class="row">
        <div class="col col-md-6">

            <div class="biolog-valueSelector-selectedObject {{hideObjectIfNoneSelected}}">
                <button type="button" class="btn btn-success btn-sm biolog-selectedObjBtn">
                    <span class="glyphicon glyphicon-check"></span> {{selectedObjName}}
                </button>
            </div>
            {{#esEach index="entities" id="objectChooser"}}
            <div class="item">
                <button type="button" class="btn btn-default btn-sm biolog-clauseObjBtn">
                    <span class="glyphicon glyphicon-book"></span> {{name}}
                </button>
            </div>
            {{/esEach}}
        </div>
    </div>
</template>
